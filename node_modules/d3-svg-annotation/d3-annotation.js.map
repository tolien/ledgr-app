{"version":3,"file":"d3-annotation.js","sources":["src/Annotation.js","src/AnnotationCollection.js","src/Handles.js","src/Note/alignment.js","src/Builder.js","src/Note/lineType-vertical.js","src/Note/lineType-horizontal.js","src/Connector/type-line.js","src/Connector/type-elbow.js","src/Connector/type-curve.js","src/Connector/end-arrow.js","src/Connector/end-dot.js","src/Subject/circle.js","src/Subject/rect.js","src/Subject/threshold.js","src/Subject/badge.js","src/Types-d3.js","src/Adapter-d3.js","index.js"],"sourcesContent":["\nexport default class Annotation {\n  constructor ({ x=0, y=0, nx, ny, dy=0, dx=0, data, type, subject, connector, note, \n    disable, id, className }) {\n\n    this._dx = nx !== undefined ? nx - x : dx\n    this._dy = ny !== undefined ? ny - y : dy \n    this._x = x \n    this._y = y\n    this.id = id\n    this._className = className || ''\n\n    this.type = type || ''\n    this.data = data\n\n    this.note = note || {}\n    this.connector = connector || {}\n    this.subject = subject || {}\n\n    this.disable = disable || []\n  }\n\n  updatePosition () {\n    if (this.type.setPosition) { \n      this.type.setPosition() \n      if (this.type.subject.selectAll(':not(.handle)').nodes().length !== 0) {\n        this.type.redrawSubject()\n      }\n    }\n  }\n\n  get className () { return this._className }\n\n  set className (className) {\n    this._className = className\n    if (this.type.setClassName) this.type.setClassName()\n  }\n\n  updateOffset () {\n    if (this.type.setOffset) {\n      this.type.setOffset() \n            \n      if (this.type.connector.selectAll(':not(.handle)').nodes().length !== 0) {\n        this.type.redrawConnector()\n      }\n\n      this.type.redrawNote()\n    }\n  }\n\n  get x () { return this._x }\n  set x (x) { \n    this._x = x; \n    this.updatePosition()\n  }\n\n  get y () { return this._y }\n  set y (y) { \n    this._y = y; \n    this.updatePosition()\n  }\n\n  get dx () { return this._dx }\n  set dx (dx) { \n    this._dx = dx; \n    this.updateOffset()\n  }\n\n  get dy () { return this._dy }\n  set dy (dy) { \n    this._dy = dy\n    this.updateOffset()\n  }\n\n  set nx (nx) { \n    this._dx = nx - this._x\n    this.updateOffset()\n  }\n\n  set ny (ny) { \n    this._dy = ny - this._y\n    this.updateOffset()\n  }\n\n  get offset () { return { x: this._dx, y: this._dy }}\n\n  set offset ({ x, y }) {\n    this._dx = x\n    this._dy = y\n    this.updateOffset()\n  }\n\n  get position () { return { x: this._x, y: this._y }}\n\n  set position ({ x, y }) {\n    this._x = x\n    this._y = y\n    this.updatePosition()\n  }\n\n  get translation () {\n    return {\n      x: this._x + this._dx,\n      y: this._y + this._dy\n    }}\n\n  get json () { \n    const json = {\n      x: this._x,\n      y: this._y,\n      dx: this._dx,\n      dy: this._dy\n    }\n\n    if (this.data && Object.keys(this.data).length > 0) json.data = this.data\n    if (this.type) json.type = this.type\n    if (this._className) json.className = this._className\n\n    if (Object.keys(this.connector).length > 0) json.connector = this.connector\n    if (Object.keys(this.subject).length > 0) json.subject = this.subject\n    if (Object.keys(this.note).length > 0) json.note = this.note\n    \n    return json\n  }\n}","export default class AnnotationCollection {\n\n  constructor ({ annotations, accessors, accessorsInverse }) {\n    this.accessors = accessors\n    this.accessorsInverse = accessorsInverse\n    this.annotations = annotations\n  }\n\n  clearTypes (newSettings) {\n    this.annotations.forEach(d => {\n      d.type = undefined\n      d.subject = newSettings && newSettings.subject || d.subject\n      d.connector = newSettings && newSettings.connector || d.connector\n      d.note = newSettings && newSettings.note || d.note\n    })\n  }\n\n  setPositionWithAccessors () {\n    this.annotations.forEach(d => {\n      d.type.setPositionWithAccessors(this.accessors)\n    })\n  }\n\n  editMode (editMode) { this.annotations.forEach(a => {\n    if (a.type) {\n      a.type.editMode = editMode\n      a.type.updateEditMode()\n    }\n  })\n  }\n\n  updateDisable (disable) {\n    this.annotations.forEach(a => {\n      a.disable = disable\n      if (a.type) {\n        disable.forEach(d => {\n          if (a.type[d]) {\n            a.type[d].remove && a.type[d].remove()\n            a.type[d] = undefined\n          }\n        })\n      }\n    })\n  }\n\n  updateTextWrap (textWrap) {\n    this.annotations.forEach(a => {\n      if (a.type && a.type.updateTextWrap) {\n        a.type.updateTextWrap(textWrap)\n      }\n    })\n  }\n\n  updateText () {\n    this.annotations.forEach(a => {\n      if (a.type && a.type.drawText) {\n        a.type.drawText()\n      }\n    })\n  }\n\n  updateNotePadding (notePadding) {\n    this.annotations.forEach(a => {\n      if (a.type) {\n        a.type.notePadding = notePadding\n      }\n    })\n  }\n\n  get json () { \n    return this.annotations.map(a => {      \n      const json = a.json\n      if (this.accessorsInverse && a.data) {\n        json.data = {}\n        Object.keys(this.accessorsInverse).forEach(k => {\n          json.data[k] = this.accessorsInverse[k]({ x: a.x, y: a.y})\n\n          //TODO make this feasible to map back to data for other types of subjects\n        })\n      }\n      return json\n    })\n  }\n\n  get noteNodes () {\n    return this.annotations.map(a => ({ ...a.type.getNoteBBoxOffset(), positionX: a.x, positionY: a.y }))\n  }\n\n  //TODO: come back and rethink if a.x and a.y are applicable in all situations\n  // get connectorNodes() {\n  //   return this.annotations.map(a => ({ ...a.type.getConnectorBBox(), startX: a.x, startY: a.y}))\n  // }\n\n  // get subjectNodes() {\n  //   return this.annotations.map(a => ({ ...a.type.getSubjectBBox(), startX: a.x, startY: a.y}))\n  // }\n\n  // get annotationNodes() {\n  //   return this.annotations.map(a => ({ ...a.type.getAnnotationBBox(), startX: a.x, startY: a.y}))\n  // }\n}\n","import { select } from 'd3-selection'\nimport { drag } from 'd3-drag'\n\nexport const pointHandle = ({ cx=0, cy=0 }) => {\n  return { move: { x: cx, y: cy} }\n}\n\nexport const circleHandles = ({ cx=0, cy =0, r1, r2, padding }) => {\n  const h = { move: { x: cx, y: cy}}\n       \n  if (r1 !== undefined) {\n    h.r1 = { x: cx + r1/Math.sqrt(2), y: cy + r1/Math.sqrt(2) }\n  }\n  \n  if (r2 !== undefined) {\n    h.r2 = { x: cx + r2/Math.sqrt(2), y: cy + r2/Math.sqrt(2) }\n  }\n\n  if (padding !== undefined) {\n    h.padding = { x: cx + r1 + padding, y: cy}\n  }\n\n  return h\n}\n\nexport const rectHandles = ({ x1=0, y1=0, x2=x1, y2=y1, width, height }) => {\n  \n  const w = width || Math.abs(x2 - x1)\n  const h = height || Math.abs(y2 - y1)\n\n  return {\n    move: {\n      x: Math.min(x1, x2) + w/2,\n      y: Math.min(y1, y2) - 10\n    },\n    width: {\n      x: Math.max(x1, x2),\n      y: Math.min(y1, y2) + h/2\n    },\n    height: {\n      x: Math.min(x1, x2) + w/2,\n      y: Math.max(y1, y2)\n    }\n  }\n}\n\nexport const lineHandles = ({ x1, y1, x2, y2, x, y}) => {\n\n  const minY = Math.min(y1, y2)\n  const minX = Math.min(x1, x2)\n\n  const height = Math.abs(y2 - y1)\n  const width = Math.abs(x2 - x1)\n  \n  return {\n    move: {\n      x: x || minX + width/2,\n      y: y || minY + height/2\n    }\n  }\n}\n\n//arc handles\nexport const addHandles = ({ group, handles, r=10}) => { \n   //give it a group and x,y to draw handles\n   //then give it instructions on what the handles change \n  const h = group.selectAll('circle.handle')\n    .data(handles)\n\n  h.enter()\n    .append('circle')\n    .attr('class', 'handle')\n    .call(drag()\n      .container(select('g.annotations').node())\n      .on('start', d => d.start && d.start(d))\n      .on('drag', d => d.drag && d.drag(d))\n      .on('end', d => d.end && d.end(d))\n    )\n\n  group.selectAll('circle.handle')\n    .attr('cx', d => d.x)\n    .attr('cy', d => d.y)\n    .attr('r', d => d.r || r)\n    .attr('class', d => `handle ${d.className || ''}`)\n\n  h.exit()\n    .remove()\n    \n}\n\n","\nexport const leftRightDynamic = (align, y) => {\n  if (align === \"dynamic\" || align === \"left\" || align === \"right\") {\n    if (y < 0) { align = \"top\" }\n    else { align = \"bottom\" } \n  }\n  return align\n}\n\nexport const topBottomDynamic = (align, x) => {\n  if (align === \"dynamic\" || align === \"top\" || align === \"bottom\") {\n    if (x < 0) { align = \"right\" }\n    else { align = \"left\" }      \n  }\n  return align\n}\n\nconst orientationTopBottom = [\"topBottom\", \"top\", \"bottom\"]\nconst orientationLeftRight = [\"leftRight\", \"left\", \"right\"]\n\nexport default ({ padding=0, bbox={x:0, y:0, width:0, height:0}, align, orientation, offset={x:0, y:0} }) => {\n  let x = -bbox.x \n  let y = 0//-bbox.y\n  if ( orientationTopBottom.indexOf(orientation) !== -1 ) {\n    align = topBottomDynamic(align, offset.x)\n    if (offset.y < 0 && orientation === \"topBottom\" || orientation === \"top\") { \n      y -= bbox.height + padding\n    } else {\n      y += padding\n    }\n\n    if ( align === \"middle\" ) {\n      x -= bbox.width/2\n    } else if (align === \"right\" ) {\n      x -= bbox.width\n    } \n\n  } else if ( orientationLeftRight.indexOf(orientation) !== -1 ) {\n    align = leftRightDynamic(align, offset.y)\n    if (offset.x < 0 && orientation === \"leftRight\" || orientation === \"left\") { \n      x -= bbox.width + padding\n    } else {\n      x += padding\n    }\n\n    if ( align === \"middle\" ) {\n      y -= bbox.height/2\n    } else if (align === \"top\" ) {\n      y -= bbox.height\n    }\n  } \n\n  return { x, y }\n}","import { line, arc, curveLinear } from \"d3-shape\"\n\nexport const lineBuilder = ({ data, curve=curveLinear, canvasContext, className, classID }) => { \n  const lineGen = line()\n    .curve(curve)\n\n  const builder = {\n    type: 'path',\n    className,\n    classID,\n    data\n  }\n\n  if (canvasContext) {\n    lineGen.context(canvasContext)\n    builder.pathMethods = lineGen\n\n  } else {\n    builder.attrs = {\n      d: lineGen(data)\n    }\n  }\n\n  return builder\n}\n\nexport const arcBuilder = ({ data, canvasContext, className, classID }) => {\n\n  const builder = {\n    type: 'path',\n    className,\n    classID,\n    data\n  }\n\n  const arcShape = arc()\n    .innerRadius(data.innerRadius || 0)\n    .outerRadius(data.outerRadius || data.radius || 2)\n    .startAngle(data.startAngle || 0)\n    .endAngle(data.endAngle || 2*Math.PI)\n\n  if (canvasContext) {\n    arcShape.context(canvasContext)\n    builder.pathMethods = lineGen\n\n  } else {\n    \n    builder.attrs = {\n      d: arcShape()\n    }\n  }\n\n  return builder\n}","import { lineBuilder } from '../Builder'\nimport { leftRightDynamic } from './alignment'\n\nexport default ({ align, x=0, y=0, bbox, offset }) => {\n  align = leftRightDynamic(align, offset.y)\n\n  if (align === \"top\") { y -= bbox.height } \n  else if (align === \"middle\") { y -= bbox.height/2 }\n\n  const data = [[x, y], [x, y + bbox.height]]\n  return { components: [lineBuilder({ data, className : \"note-line\" })] }\n}","import { lineBuilder } from '../Builder'\nimport { topBottomDynamic } from './alignment'\n\nexport default ({ align, x=0, y=0, offset, bbox }) => {\n  align = topBottomDynamic(align, offset.x)\n\n  if (align === \"right\") { x -= bbox.width }\n  else if (align === \"middle\") { x -= bbox.width/2 }\n\n  const data = [[x, y], [x + bbox.width, y]]\n  return { components: [lineBuilder({ data, className : \"note-line\" })] }\n}","import { lineBuilder } from '../Builder'\n\nexport const lineSetup = ({ type, subjectType }) => {\n  let annotation = type.annotation\n  let offset = annotation.position\n  \n  let x1 = annotation.x - offset.x,\n    x2 = x1 + annotation.dx,\n    y1 = annotation.y - offset.y,\n    y2 = y1 + annotation.dy\n\n\n  const subjectData = annotation.subject\n\n  if (subjectType === \"circle\" && (subjectData.outerRadius || subjectData.radius)) {\n    const h =  Math.sqrt((x1 - x2)*(x1 - x2) + (y1 - y2)*(y1 - y2))\n    const angle = Math.asin(-y2/h)\n    const r = subjectData.outerRadius || subjectData.radius + (subjectData.radiusPadding || 0)\n\n    x1 = Math.abs(Math.cos(angle)*r)*(x2 < 0 ? -1 : 1)\n    y1 = Math.abs(Math.sin(angle)*r)*(y2 < 0 ? -1 : 1)\n\n  }\n\n  if (subjectType === \"rect\") {\n    const { width, height } = subjectData\n    \n    if (width > 0 && annotation.dx > 0 || width < 0 && annotation.dx < 0) {\n      if (Math.abs(width) > Math.abs(annotation.dx)) x1 = width/2\n      else x1 = width\n    } \n    if (height > 0 && annotation.dy > 0 || height < 0 && annotation.dy < 0) {\n      if (Math.abs(height) > Math.abs(annotation.dy)) y1 = height/2\n      else y1 = height\n    }\n    if (x1 === width/2 && y1 === height/2) { x1 = x2; y1 = y2;}\n  }\n\n\n  return [[x1, y1], [x2, y2]]\n}\n\nexport default (connectorData) => {\n  const data = lineSetup(connectorData)\n  return { components: [lineBuilder({ data, className : \"connector\" })]} \n}","import { lineBuilder } from '../Builder'\n\nexport default ({ type, subjectType }) => {\n\n  const annotation = type.annotation\n  const offset = annotation.position\n\n  let x1 = annotation.x - offset.x,\n    x2 = x1 + annotation.dx,\n    y1 = annotation.y - offset.y,\n    y2 = y1 + annotation.dy\n\n  const subjectData = annotation.subject\n\n  if (subjectType === \"rect\") {\n    const { width, height } = subjectData\n    \n    if (width > 0 && annotation.dx > 0 || width < 0 && annotation.dx < 0) {\n      if (Math.abs(width) > Math.abs(annotation.dx)) x1 = width/2\n      else x1 = width\n    } \n    if (height > 0 && annotation.dy > 0 || height < 0 && annotation.dy < 0) {\n      if (Math.abs(height) > Math.abs(annotation.dy)) y1 = height/2\n      else y1 = height\n    }\n    if (x1 === width/2 && y1 === height/2) { x1 = x2; y1 = y2;}\n  }\n\n  let data = [[x1, y1], [x2, y2]]\n\n  let diffY = y2 - y1\n  let diffX = x2 - x1\n  let xe = x2 \n  let ye = y2\n  let opposite = y2 < y1 && x2 > x1 || x2 < x1 && y2 > y1 ? -1 : 1\n\n  if (Math.abs(diffX) < Math.abs(diffY)) {\n    xe = x2\n    ye = y1 + diffX*opposite\n  } else {\n    ye = y2\n    xe = x1 + diffY*opposite\n  }\n  \n  if (subjectType === \"circle\" && (subjectData.outerRadius || subjectData.radius)) {\n    const r = (subjectData.outerRadius || subjectData.radius) + (subjectData.radiusPadding || 0)\n    const length = r/Math.sqrt(2)\n\n    if (Math.abs(diffX) > length && Math.abs(diffY) > length) {\n      x1 = length*(x2 < 0 ? -1 : 1)\n      y1 = length*(y2 < 0 ? -1 : 1)\n      data = [[x1, y1], [xe , ye ], [x2, y2]]\n\n    } else if (Math.abs(diffX) > Math.abs(diffY)) {\n      const angle = Math.asin(-y2/r)\n      x1 = Math.abs(Math.cos(angle)*r)*(x2 < 0 ? -1 : 1)\n      data = [[ x1, y2], [x2, y2]]\n    } else {\n      const angle = Math.acos(x2/r)\n      y1 = Math.abs(Math.sin(angle)*r)*(y2 < 0 ? -1 : 1)\n      data = [[ x2, y1], [x2, y2]]\n    }\n  } else {\n    data = [[x1, y1], [xe , ye], [x2, y2]]\n  }\n\n  return { components: [lineBuilder({ data, className: \"connector\"})]}\n}\n","import { lineBuilder } from '../Builder'\nimport { event } from 'd3-selection'\nimport { lineSetup } from './type-line'\nimport { curveCatmullRom } from 'd3-shape'\nimport { pointHandle } from '../Handles'\n\nexport default ({ type, connectorData, subjectType }) => {\n\n  if (!connectorData) { connectorData = {} }\n  if (!connectorData.points || typeof connectorData.points === \"number\") { \n    connectorData.points = createPoints(type.annotation.offset, connectorData.points) \n  }\n  if (!connectorData.curve) { connectorData.curve = curveCatmullRom }\n\n  let handles = []\n\n  if (type.editMode) {\n    const cHandles = connectorData.points\n      .map((c,i) => ({...pointHandle({cx: c[0], cy: c[1]}), index: i}))\n\n    const updatePoint = (index) => {      \n      connectorData.points[index][0] += event.dx\n      connectorData.points[index][1] += event.dy\n      type.redrawConnector()\n    }\n  \n    handles = type.mapHandles(cHandles\n      .map(h => ({ ...h.move, drag: updatePoint.bind(type, h.index)})))\n\n  }\n\n  let data = lineSetup({ type, subjectType })\n  data = [data[0], ...connectorData.points, data[1]]\n  const components = [lineBuilder({ data, curve: connectorData.curve, className: \"connector\" })]\n\n  return { components , handles }\n}\n\nconst createPoints = function ( offset, anchors=2) {\n  const diff = { x: offset.x/(anchors + 1), y: offset.y/(anchors + 1) }\n  const p = []\n\n  let i = 1 \n  for (; i <= anchors; i++) {\n    p.push([diff.x*i + i%2*20, diff.y*i - i%2*20])\n  }\n  return p\n}","import { lineBuilder } from '../Builder'\n\nexport default ({ annotation, start, end }) => {\n  const offset = annotation.position\n  if (!start) { start = [annotation.dx, annotation.dy]} \n  else { start = [-end[0] + start[0], - end[1] + start[1]]}\n  if (!end) { end = [annotation.x - offset.x, annotation.y - offset.y]}\n\n  let x1 = end[0],\n    y1 = end[1];\n\n  let dx = start[0] \n  let dy = start[1] \n\n  let size = 10;\n  let angleOffset = 16/180*Math.PI\n  let angle = Math.atan(dy/dx) \n\n  if (dx < 0 ) {\n    angle += Math.PI\n  }\n\n  const data = [[x1, y1], \n    [Math.cos(angle + angleOffset)*size + x1, Math.sin(angle + angleOffset)*size + y1],\n    [Math.cos(angle - angleOffset)*size + x1, Math.sin(angle - angleOffset)*size + y1],\n    [x1, y1]]\n\n  //TODO add in reverse\n  // if (canvasContext.arrowReverse){\n  //   data = [[x1, y1], \n  //   [Math.cos(angle + angleOffset)*size, Math.sin(angle + angleOffset)*size],\n  //   [Math.cos(angle - angleOffset)*size, Math.sin(angle - angleOffset)*size],\n  //   [x1, y1]\n  //   ]\n  // } else {\n  //   data = [[x1, y1], \n  //   [Math.cos(angle + angleOffset)*size, Math.sin(angle + angleOffset)*size],\n  //   [Math.cos(angle - angleOffset)*size, Math.sin(angle - angleOffset)*size],\n  //   [x1, y1]\n  //   ]\n  // }\n\n  return { components: [lineBuilder({ data, className : 'connector-end connector-arrow', classID: 'connector-end' })] }\n}\n","import { arcBuilder } from '../Builder'\n\nexport default ({ line }) => {\n  \n  let dot = arcBuilder({ className : 'connector-end connector-dot', classID: 'connector-end', data: { radius: 3} })\n  dot.attrs.transform = `translate(${line.data[0][0]}, ${line.data[0][1]})`\n  \n  return { components: [dot] }\n}\n","import { circleHandles } from '../Handles'\nimport { arcBuilder } from '../Builder'\nimport { event } from 'd3-selection'\n\nexport default ({ subjectData, type}) => {\n  if (!subjectData.radius && !subjectData.outerRadius ) { subjectData.radius = 20 }\n\n  let handles = []\n  const c = arcBuilder({ data: subjectData, className: \"subject\" })\n  if (type.editMode) {\n    const h = circleHandles({\n      r1: c.data.outerRadius || c.data.radius,\n      r2: c.data.innerRadius,\n      padding: subjectData.radiusPadding\n    })\n\n    const updateRadius = (attr) => {      \n      const r = subjectData[attr] + event.dx*Math.sqrt(2)\n      subjectData[attr] = r\n      type.redrawSubject()\n      type.redrawConnector()\n    }\n\n    const cHandles = [\n      { ...h.r1, drag: updateRadius.bind(type, subjectData.outerRadius !== undefined ? 'outerRadius': 'radius')}\n    ]\n\n    if (subjectData.innerRadius) {\n      cHandles.push({ ...h.r2, drag: updateRadius.bind(type, 'innerRadius')})\n    }\n    handles = type.mapHandles(cHandles)\n  }\n\n  return { components: [c], handles }\n}","import { lineBuilder } from '../Builder'\nimport { event } from 'd3-selection'\n\nexport default ({ subjectData, type}) => {\n  if (!subjectData.width) { subjectData.width = 100 }\n  if (!subjectData.height) { subjectData.height = 100 }\n\n  let handles = []\n  let { width, height } = subjectData\n\n  const data = [[0, 0], \n    [ width, 0], \n    [ width, height], \n    [0, height],\n    [0, 0]]\n  let rect = lineBuilder({ data, className : 'subject'})\n\n  if (type.editMode) {\n\n    const updateWidth = () => {  \n      subjectData.width = event.x\n      type.redrawSubject()\n      type.redrawConnector()\n    }\n\n    const updateHeight = () => {\n      subjectData.height = event.y\n      type.redrawSubject()\n      type.redrawConnector()\n    }\n\n    const rHandles = [{ x: width, y: height/2, drag: updateWidth.bind(type) },\n      { x: width/2, y: height, drag: updateHeight.bind(type) }\n    ]\n\n    handles = type.mapHandles(rHandles)\n\n  }\n\n  return { components: [rect], handles }\n}","import { lineBuilder } from '../Builder'\n\n\nexport default ({ subjectData, type }) => {\n  const offset = type.annotation.position\n\n  let x1 = (subjectData.x1 !== undefined ? subjectData.x1 : offset.x) - offset.x,\n    x2 = (subjectData.x2 !== undefined ? subjectData.x2 : offset.x) - offset.x,\n    y1 = (subjectData.y1 !== undefined ? subjectData.y1 : offset.y) - offset.y,\n    y2 = (subjectData.y2 !== undefined ? subjectData.y2 : offset.y) - offset.y\n\n  const data = [[x1, y1], [x2, y2]]\n  return { components: [lineBuilder({ data, className : 'subject'})]}\n}","import { lineBuilder, arcBuilder } from '../Builder'\nimport { event } from 'd3-selection'\n\nexport default ({ subjectData, type }) => {\n  const typeSettings = type.typeSettings && type.typeSettings.subject\n\n  if (!subjectData.radius ) {\n    if (typeSettings && typeSettings.radius) {\n      subjectData.radius = typeSettings.radius\n    } else {\n      subjectData.radius = 14\n    }\n  }\n  if (!subjectData.x) {\n    if (typeSettings && typeSettings.x) {\n      subjectData.x = typeSettings.x\n    } else {\n      subjectData.x = \"left\"\n    }\n  }\n  if (!subjectData.y) {\n    if (typeSettings && typeSettings.y) {\n      subjectData.y = typeSettings.y\n    } else {\n      subjectData.y = \"top\"\n    }\n  }\n\n  let handles = []\n  const radius = subjectData.radius \n  const innerRadius = radius*.7\n  const x = subjectData.x === \"left\" ? -radius : radius\n  const y = subjectData.y === \"top\" ? -radius : radius\n  const transform = `translate(${x}, ${y})`\n  const circlebg = arcBuilder({ className: 'subject', data: { radius} }) \n  circlebg.attrs.transform = transform\n\n  const circle = arcBuilder({ className: 'subject-ring', data: { outerRadius: radius, innerRadius} })\n  circle.attrs.transform = transform\n\n  const pointer = lineBuilder({ className: 'subject-pointer',\n    data: [[0, 0], [x, 0], [0, y], [0, 0]]\n  })\n\n  if (type.editMode) {\n\n    const dragBadge = () => {\n      subjectData.x = event.x < 0 ? \"left\" : \"right\"\n      subjectData.y = event.y < 0 ? \"top\" : \"bottom\"\n      type.redrawSubject()\n    }\n\n    const bHandles = [{ x: x*2, y: y*2, drag: dragBadge.bind(type)}]\n    handles = type.mapHandles(bHandles)\n\n  }\n\n  let text\n  if (subjectData.text) {\n    text = {\n      type: \"text\",\n      className: \"badge-text\",\n      attrs: {\n        text: subjectData.text,\n        \"text-anchor\": \"middle\",\n        dy: \".25em\",\n        x,\n        y\n      }\n    }\n  }\n  return { components: [pointer, circlebg, circle, text], handles }\n}","import { select, event } from 'd3-selection'\nimport { addHandles } from './Handles'\n\n//Note options\nimport noteAlignment from './Note/alignment'\nimport noteVertical from './Note/lineType-vertical'\nimport noteHorizontal from './Note/lineType-horizontal'\n\n//Connector options\nimport connectorLine from './Connector/type-line'\nimport connectorElbow from './Connector/type-elbow'\nimport connectorCurve from './Connector/type-curve'\nimport connectorArrow from './Connector/end-arrow'\nimport connectorDot from './Connector/end-dot'\n\n//Subject options\nimport subjectCircle from './Subject/circle'\nimport subjectRect from './Subject/rect'\nimport subjectThreshold from './Subject/threshold'\nimport subjectBadge from './Subject/badge'\n\nexport class Type {\n  constructor ({ a, annotation, editMode, dispatcher, notePadding, accessors }) {\n    this.a = a\n\n    this.note = annotation.disable.indexOf(\"note\") === -1 && a.select('g.annotation-note')\n    this.noteContent = this.note && a.select('g.annotation-note-content')\n    this.connector = annotation.disable.indexOf(\"connector\") === -1 && a.select('g.annotation-connector')\n    this.subject = annotation.disable.indexOf(\"subject\") === -1 && a.select('g.annotation-subject')\n    this.dispatcher = dispatcher\n\n    if (dispatcher) {\n      const handler = addHandlers.bind(null, dispatcher, annotation)\n      handler({ component: this.note, name: 'note' })\n      handler({ component: this.connector, name: 'connector' })\n      handler({ component: this.subject, name: 'subject' })\n    }\n  \n    this.annotation = annotation\n    this.editMode = annotation.editMode || editMode\n    this.notePadding = notePadding !== undefined ? notePadding : 3\n    this.offsetCornerX = 0\n    this.offsetCornerY = 0\n\n    if (accessors && annotation.data) {\n      this.init(accessors)\n    }\n  }\n\n  init (accessors) {\n    if (!this.annotation.x) {\n      this.mapX(accessors)\n    }\n    if (!this.annotation.y) {\n      this.mapY(accessors)\n    }\n  }\n\n  mapY (accessors) {\n    if (accessors.y) {\n      this.annotation.y = accessors.y(this.annotation.data)\n    }\n  }\n\n  mapX (accessors) {\n    if (accessors.x) {\n      this.annotation.x = accessors.x(this.annotation.data)\n    }\n  }\n\n\n  updateEditMode () {\n    this.a.selectAll('circle.handle')\n      .remove()\n  }\n\n  drawOnSVG (component, builders) {\n    if (!Array.isArray(builders)) {\n      builders = [ builders ]\n    }\n    \n    builders\n      .filter(b => b)\n      .forEach(({ type, className, attrs, handles, classID }) => {\n        if (type === \"handle\") {\n          addHandles({ group: component, r: attrs && attrs.r, handles })\n        } else {\n          newWithClass(component, [this.annotation], type, className, classID)\n          const el = component.select(`${type}.${classID || className}`) \n          const addAttrs = Object.keys(attrs)\n          const removeAttrs = []\n          \n          const currentAttrs = el.node().attributes\n          for(let i = currentAttrs.length - 1; i >= 0; i--) {\n            const name = currentAttrs[i].name\n            if (addAttrs.indexOf(name) === -1 && name !== \"class\") removeAttrs.push(name)\n          }\n\n          addAttrs.forEach(attr => {\n            if (attr === \"text\") {\n              el.text(attrs[attr])\n            } else {\n              el.attr(attr, attrs[attr])\n            }\n          })\n\n          removeAttrs.forEach(attr => el.attr(attr, null))\n        }\n      })\n  }\n\n  //TODO: how to extend this to a drawOnCanvas mode? \n\n  getNoteBBox () { return bboxWithoutHandles(this.note, '.annotation-note-content text')}\n  getNoteBBoxOffset () { \n    const bbox = bboxWithoutHandles(this.note, '.annotation-note-content')\n    const transform = this.noteContent.attr('transform').split(/\\(|\\,|\\)/g)\n    bbox.offsetCornerX = parseFloat(transform[1]) + this.annotation.dx\n    bbox.offsetCornerY = parseFloat(transform[2]) + this.annotation.dy\n    bbox.offsetX = this.annotation.dx\n    bbox.offsetY = this.annotation.dy\n    return bbox \n  }\n\n  drawSubject (context={}) {\n    const subjectData = this.annotation.subject\n    const type = context.type\n    const subjectParams = { type: this, subjectData}\n\n    let subject = {}\n    if (type === \"circle\") subject = subjectCircle(subjectParams)\n    else if (type === \"rect\") subject = subjectRect(subjectParams)\n    else if (type === \"threshold\") subject = subjectThreshold(subjectParams)\n    else if (type === \"badge\") subject = subjectBadge(subjectParams)\n\n    let { components=[], handles=[] } = subject\n    if (this.editMode) {\n      handles = handles.concat(this.mapHandles([{ drag: this.dragSubject.bind(this)}]))\n      components.push({ type: \"handle\", handles })\n    }\n\n    return components\n  }\n\n  drawConnector (context={}) {\n    const connectorData = this.annotation.connector\n    const type = connectorData.type || context.type\n    const connectorParams = { type: this, connectorData}\n    connectorParams.subjectType = this.typeSettings && this.typeSettings.subject && this.typeSettings.subject.type \n\n    let connector = {}\n    if (type === \"curve\") connector = connectorCurve(connectorParams)\n    else if (type === \"elbow\") connector = connectorElbow(connectorParams)\n    else connector = connectorLine(connectorParams)\n\n    let { components=[], handles=[] } = connector\n    const line = components[0]\n    const endType = connectorData.end || context.end\n    let end = {}\n    if (endType === \"arrow\") {\n      let s = line.data[1]\n      const e = line.data[0]\n      const distance = Math.sqrt(Math.pow(s[0] - e[0], 2) + Math.pow(s[1] - e[1], 2))\n      if (distance < 5 && line.data[2]) {\n        s = line.data[2]\n      }\n      end = connectorArrow({ annotation: this.annotation, start: s, end: e })\n    } else if (endType === \"dot\") {\n      end = connectorDot({ line })\n    }\n\n    if (end.components) { components = components.concat(end.components)}\n\n    if (this.editMode) {\n      if (handles.length !== 0) components.push({ type: \"handle\", handles })\n    }\n    return components;\n  }\n\n  drawNote (context={}) {\n    const noteData = this.annotation.note\n    const align = noteData.align || context.align || 'dynamic'\n    const noteParams = { bbox: context.bbox, align, offset: this.annotation.offset }\n    const lineType = noteData.lineType || context.lineType\n    let note={}\n    if (lineType === \"vertical\") note = noteVertical(noteParams)\n    else if (lineType === \"horizontal\") note = noteHorizontal(noteParams)\n\n    let { components=[], handles=[] } = note\n    if (this.editMode) {\n      handles = this.mapHandles([{ x: 0, y: 0, drag: this.dragNote.bind(this)}])\n      components.push({ type: \"handle\", handles })\n    }\n    return components\n  }\n\n  drawNoteContent (context) {\n    const noteData = this.annotation.note\n    const padding = noteData.padding !== undefined ? noteData.padding : this.notePadding\n    let orientation = noteData.orientation || context.orientation || 'topBottom'\n    const lineType = noteData.lineType || context.lineType\n    const align = noteData.align || context.align || 'dynamic'\n    \n    if (lineType === \"vertical\") orientation =  \"leftRight\"\n    else if (lineType === \"horizontal\") orientation = \"topBottom\"\n  \n    const noteParams = { padding, bbox: context.bbox, offset: \n    this.annotation.offset, orientation, align }\n    const { x, y } = noteAlignment(noteParams)\n    this.offsetCornerX = x + this.annotation.dx\n    this.offsetCornerY = y + this.annotation.dy\n    this.note && this.noteContent.attr('transform', `translate(${x}, ${y})`)\n    \n    return []\n  } \n\n  drawOnScreen (component, drawFunction) { return this.drawOnSVG( component, drawFunction ) }\n\n  redrawSubject () {\n    this.subject && this.drawOnScreen( this.subject, this.drawSubject())\n  }\n\n  redrawConnector () {\n    this.connector && this.drawOnScreen( this.connector, this.drawConnector())\n  }\n\n  redrawNote (bbox=this.getNoteBBox()) {\n    this.noteContent && this.drawOnScreen( this.noteContent, this.drawNoteContent({ bbox }))\n    this.note && this.drawOnScreen( this.note, this.drawNote({ bbox }))  \n  }\n\n  setPosition () {\n    const position = this.annotation.position \n    this.a.attr('transform', `translate(${position.x}, ${position.y})`)\n  }\n\n  setOffset () {\n    if (this.note) {\n      const offset = this.annotation.offset\n      this.note.attr('transform', `translate(${offset.x}, ${offset.y})`)\n    }\n  }\n\n  setPositionWithAccessors (accessors) {\n    if (accessors && this.annotation.data) {\n      this.mapX(accessors)\n      this.mapY(accessors)\n    }\n    this.setPosition()\n  }\n\n\n  setClassName () {\n    this.a.attr(\"class\", `annotation ${this.className && this.className()} ${this.editMode ? \"editable\" : \"\"} ${this.annotation.className || ''}`)\n  }\n\n  draw () {\n    this.setClassName()\n    this.setPosition()\n    this.setOffset()\n    this.redrawSubject()\n    this.redrawConnector()\n    this.redrawNote()\n  }\n\n  dragstarted () { event.sourceEvent.stopPropagation(); \n    this.dispatcher && this.dispatcher.call(\"dragstart\", this.a, this.annotation)\n    this.a.classed(\"dragging\", true) \n    this.a.selectAll(\"circle.handle\").style(\"pointer-events\", \"none\")\n  }\n  dragended () { \n    this.dispatcher && this.dispatcher.call(\"dragend\", this.a, this.annotation)\n    this.a.classed(\"dragging\", false)\n    this.a.selectAll(\"circle.handle\").style(\"pointer-events\", \"all\")\n  }\n\n  dragSubject () {\n    const position = this.annotation.position\n    position.x += event.dx\n    position.y += event.dy\n    this.annotation.position = position\n  }\n\n  dragNote () {\n    const offset = this.annotation.offset\n    offset.x += event.dx\n    offset.y += event.dy\n    this.annotation.offset = offset\n  }\n\n  mapHandles (handles) {\n    return handles\n    .map(h => ({ ...h, \n      start: this.dragstarted.bind(this), end: this.dragended.bind(this) }))\n  }\n}\n\nexport const customType = (initialType, typeSettings, init) => {\n  return class customType extends initialType {\n    constructor (settings) {\n      super(settings)\n      this.typeSettings = typeSettings\n\n      if (typeSettings.disable) {\n        typeSettings.disable.forEach(d => {\n          this[d] = undefined\n          if (d === \"note\") {\n            this.noteContent = undefined\n          }\n        })\n      }\n    }\n\n    static init (annotation, accessors) { \n      super.init(annotation, accessors); \n      if (init) {\n        annotation = init(annotation, accessors) \n      }\n      return annotation\n    }\n\n    className () { return `${typeSettings.className || super.className && super.className() || ''}`}\n\n    drawSubject (context) {\n      this.typeSettings.subject = Object.assign({}, typeSettings.subject, this.typeSettings.subject)\n      return super.drawSubject({ ...context, ...this.typeSettings.subject })\n    }\n\n    drawConnector (context) {\n      this.typeSettings.connector = Object.assign({}, typeSettings.connector, this.typeSettings.connector)\n      return super.drawConnector({ ...context, ...typeSettings.connector, ...this.typeSettings.connector })\n    }\n\n    drawNote (context) {\n      this.typeSettings.note = Object.assign({}, typeSettings.note, this.typeSettings.note)\n      return super.drawNote({ ...context, ...typeSettings.note, ...this.typeSettings.note })\n    }\n\n    drawNoteContent (context) {\n      return super.drawNoteContent({ ...context, ...typeSettings.note, ...this.typeSettings.note })\n    }\n  }\n}\n\nexport class d3NoteText extends Type {\n\n  constructor (params) {\n    super(params)\n    this.textWrap = params.textWrap || 120\n    this.drawText()\n  }\n\n  updateTextWrap (textWrap) {\n    this.textWrap = textWrap\n    this.drawText()\n  }\n\n  //TODO: add update text functionality\n\n  drawText () {\n    if (this.note) {\n      \n      newWithClass(this.note, [this.annotation], 'g', 'annotation-note-content')\n\n      const noteContent = this.note.select('g.annotation-note-content')\n      newWithClass(noteContent, [this.annotation], 'rect', 'annotation-note-bg')\n      newWithClass(noteContent, [this.annotation], 'text', 'annotation-note-label')\n      newWithClass(noteContent, [this.annotation], 'text', 'annotation-note-title')\n\n      let titleBBox = { height: 0 }\n      const label = this.a.select('text.annotation-note-label')\n      const wrapLength = this.annotation.note && this.annotation.note.wrap || \n        this.typeSettings && this.typeSettings.note && this.typeSettings.note.wrap ||\n        this.textWrap \n\n      if (this.annotation.note.title) {\n        const title = this.a.select('text.annotation-note-title')\n        title.text(this.annotation.note.title)\n        title.call(wrap, wrapLength)\n        titleBBox = title.node().getBBox()\n      }\n\n      label.text(this.annotation.note.label)\n        .attr('dx', '0')\n      label.call(wrap, wrapLength)\n\n      label.attr('y', titleBBox.height * 1.1 || 0)\n\n      const bbox = this.getNoteBBox()\n      this.a.select('rect.annotation-note-bg')\n        .attr('width', bbox.width)\n        .attr('height', bbox.height)\n    }\n  }\n}\n\nexport const d3Label = customType(d3NoteText, {\n  className: \"label\", \n  note: { align: \"middle\"}\n})\n\nexport const d3Callout = customType(d3NoteText, {\n  className: \"callout\",\n  note: { lineType: \"horizontal\" }\n})\n\nexport const d3CalloutElbow = customType(d3Callout, {\n  className: \"callout elbow\",\n  connector: { type: \"elbow\" }\n})\n\nexport const d3CalloutCurve = customType(d3Callout, {\n  className: \"callout curve\",\n  connector: { type: \"curve\" }\n})\n\nexport const d3Badge = customType(Type, {\n  className: \"badge\",\n  subject: { type: \"badge\"},\n  disable: ['connector', 'note']\n})\n\n\nexport const d3CalloutCircle = customType(d3CalloutElbow, {\n  className: \"callout circle\",\n  subject: { type: \"circle\"}\n})\n\nexport const d3CalloutRect = customType(d3CalloutElbow, {\n  className: \"callout rect\",\n  subject: { type: \"rect\"}\n})\n\n\nclass ThresholdMap extends d3Callout {\n\n  mapY (accessors) {\n    super.mapY(accessors)\n    const a = this.annotation\n    if ((a.subject.x1 || a.subject.x2) && a.data && accessors.y) {\n      a.y = accessors.y(a.data)\n    }\n  }\n\n  mapX (accessors) {\n    super.mapX(accessors)\n    const a = this.annotation\n    if ((a.subject.y1 || a.subject.y2) && a.data && accessors.x) {\n      a.x = accessors.x(a.data)\n    }\n  }\n}\n\nexport const d3XYThreshold = customType(ThresholdMap, {\n  className: \"callout xythreshold\",\n  subject: { type: \"threshold\"}\n})\n\n\n\nexport const newWithClass = (a, d, type, className, classID) => {\n  const group = a.selectAll(`${type}.${classID || className}`).data(d)\n  group.enter()\n    .append(type)\n    .merge(group)\n    .attr('class', className)\n\n  group.exit().remove()\n  return a\n}\n\n\nconst addHandlers = ( dispatcher, annotation, { component, name }) => {\n  if (component) {\n    component\n    .on(\"mouseover.annotations\", () => {\n      dispatcher.call(`${name}over`, component, annotation)})\n    .on(\"mouseout.annotations\", () => dispatcher.call(`${name}out`, component, annotation))\n    .on(\"click.annotations\", () => dispatcher.call(`${name}click`, component, annotation))\n  }\n}\n\n//Text wrapping code adapted from Mike Bostock\nconst wrap = (text, width, lineHeight=1.2) => {\n  text.each(function () {\n    const text = select(this),\n      words = text.text().split(/[ \\t\\r\\n]+/).reverse().filter(w => w !== \"\")\n    let word,\n      line = [],\n      tspan = text.text(null)\n        .append(\"tspan\")\n        .attr(\"x\", 0)\n        .attr(\"dy\", .8 + \"em\")\n\n    while (word = words.pop()) {\n      line.push(word);\n      tspan.text(line.join(\" \"));\n      if (tspan.node().getComputedTextLength() > width && line.length > 1) {\n        line.pop();\n        tspan.text(line.join(\" \"));\n        line = [word];\n        tspan = text.append(\"tspan\")\n          .attr(\"x\", 0)\n          .attr(\"dy\", lineHeight  + \"em\").text(word);\n      }\n    }\n  });\n}\n\nconst bboxWithoutHandles = (selection, selector=':not(.handle)') => {\n  if (!selection) {\n    return { x: 0, y: 0, width: 0, height: 0}\n  }\n  \n  return selection.selectAll(selector).nodes().reduce((p, c) => {\n    const bbox = c.getBBox()\n    p.x = Math.min(p.x, bbox.x)\n    p.y = Math.min(p.y, bbox.y)\n    p.width = Math.max(p.width, bbox.width)\n\n    const yOffset = c && c.attributes && c.attributes.y\n    p.height = Math.max(p.height, (yOffset && parseFloat(yOffset.value) || 0) + bbox.height)\n    return p\n  }, { x: 0, y: 0, width: 0, height: 0});\n}\n\nexport default {\n  Type,\n  d3Label,\n  d3Callout,\n  d3CalloutElbow,\n  d3CalloutCurve,\n  d3CalloutCircle,\n  d3CalloutRect,\n  d3XYThreshold,\n  d3Badge,\n  customType\n}\n","import Annotation from \"./Annotation\";\nimport AnnotationCollection from \"./AnnotationCollection\";\nimport { newWithClass, d3Callout } from \"./Types-d3\";\nimport { select } from \"d3-selection\";\nimport { dispatch } from \"d3-dispatch\";\n\nexport default function annotation() {\n  let annotations = [],\n    collection,\n    context, //TODO: add canvas functionality\n    disable = [],\n    accessors = {},\n    accessorsInverse = {},\n    editMode = false,\n    ids,\n    type = d3Callout,\n    textWrap,\n    notePadding,\n    annotationDispatcher = dispatch(\n      \"subjectover\",\n      \"subjectout\",\n      \"subjectclick\",\n      \"connectorover\",\n      \"connectorout\",\n      \"connectorclick\",\n      \"noteover\",\n      \"noteout\",\n      \"noteclick\",\n      \"dragend\",\n      \"dragstart\"\n    ),\n    sel;\n\n  const annotation = function(selection) {\n    sel = selection;\n    //TODO: check to see if this is still needed\n    if (!editMode) {\n      selection.selectAll(\"circle.handle\").remove();\n    }\n\n    const translatedAnnotations = annotations.map(a => {\n      if (!a.type) {\n        a.type = type;\n      }\n      if (!a.disable) {\n        a.disable = disable;\n      }\n      return new Annotation(a);\n    });\n\n    collection =\n      collection ||\n      new AnnotationCollection({\n        annotations: translatedAnnotations,\n        accessors,\n        accessorsInverse,\n        ids\n      });\n\n    const annotationG = selection.selectAll(\"g\").data([collection]);\n    annotationG.enter().append(\"g\").attr(\"class\", `annotations`);\n\n    const group = selection.select(\"g.annotations\");\n    newWithClass(group, collection.annotations, \"g\", \"annotation\");\n\n    const annotation = group.selectAll(\"g.annotation\");\n\n    annotation.each(function(d) {\n      const a = select(this);\n\n      a.attr(\"class\", \"annotation\");\n\n      newWithClass(a, [d], \"g\", \"annotation-connector\");\n      newWithClass(a, [d], \"g\", \"annotation-subject\");\n      newWithClass(a, [d], \"g\", \"annotation-note\");\n      newWithClass(\n        a.select(\"g.annotation-note\"),\n        [d],\n        \"g\",\n        \"annotation-note-content\"\n      );\n      d.type =\n        d.type.toString() === \"[object Object]\"\n          ? d.type\n          : new d.type({\n              a,\n              annotation: d,\n              textWrap,\n              notePadding,\n              editMode,\n              dispatcher: annotationDispatcher,\n              accessors\n            });\n      d.type.draw();\n      d.type.drawText && d.type.drawText();\n    });\n  };\n\n  annotation.json = function() {\n    console.log(\n      \"Annotations JSON was copied to your clipboard. Please note the annotation type is not JSON compatible. It appears in the objects array in the console, but not in the copied JSON.\",\n      collection.json\n    );\n    window.copy(\n      JSON.stringify(\n        collection.json.map(a => {\n          delete a.type;\n          return a;\n        })\n      )\n    );\n    return annotation;\n  };\n\n  annotation.update = function() {\n    if (annotations && collection) {\n      annotations = collection.annotations.map(a => {\n        a.type.draw();\n        return a;\n      });\n    }\n    return annotation;\n  };\n\n  annotation.updateText = function() {\n    if (collection) {\n      collection.updateText(textWrap);\n      annotations = collection.annotations;\n    }\n    return annotation;\n  };\n\n  annotation.updatedAccessors = function() {\n    collection.setPositionWithAccessors();\n    annotations = collection.annotations;\n    return annotation;\n  };\n\n  annotation.disable = function(_) {\n    if (!arguments.length) return disable;\n    disable = _;\n    if (collection) {\n      collection.updateDisable(disable);\n      annotations = collection.annotations;\n    }\n    return annotation;\n  };\n\n  annotation.textWrap = function(_) {\n    if (!arguments.length) return textWrap;\n    textWrap = _;\n    if (collection) {\n      collection.updateTextWrap(textWrap);\n      annotations = collection.annotations;\n    }\n    return annotation;\n  };\n\n  annotation.notePadding = function(_) {\n    if (!arguments.length) return notePadding;\n    notePadding = _;\n    if (collection) {\n      collection.updateNotePadding(notePadding);\n      annotations = collection.annotations;\n    }\n    return annotation;\n  };\n  //todo think of how to handle when undefined is sent\n  annotation.type = function(_, settings) {\n    if (!arguments.length) return type;\n    type = _;\n    if (collection) {\n      collection.annotations.map(a => {\n        a.type.note &&\n          a.type.note.selectAll(\"*:not(.annotation-note-content)\").remove();\n        a.type.noteContent && a.type.noteContent.selectAll(\"*\").remove();\n        a.type.subject && a.type.subject.selectAll(\"*\").remove();\n        a.type.connector && a.type.connector.selectAll(\"*\").remove();\n        a.type.typeSettings = {};\n        a.type = type;\n\n        a.subject = (settings && settings.subject) || a.subject;\n        a.connector = (settings && settings.connector) || a.connector;\n        a.note = (settings && settings.note) || a.note;\n      });\n\n      annotations = collection.annotations;\n    }\n    return annotation;\n  };\n\n  annotation.annotations = function(_) {\n    if (!arguments.length)\n      return (collection && collection.annotations) || annotations;\n    annotations = _;\n\n    if (collection && collection.annotations) {\n      const rerun = annotations.some(\n        d => !d.type || d.type.toString() !== \"[object Object]\"\n      );\n\n      if (rerun) {\n        collection = null;\n        annotation(sel);\n      } else {\n        collection.annotations = annotations;\n      }\n    }\n    return annotation;\n  };\n\n  annotation.context = function(_) {\n    if (!arguments.length) return context;\n    context = _;\n    return annotation;\n  };\n\n  annotation.accessors = function(_) {\n    if (!arguments.length) return accessors;\n    accessors = _;\n    return annotation;\n  };\n\n  annotation.accessorsInverse = function(_) {\n    if (!arguments.length) return accessorsInverse;\n    accessorsInverse = _;\n    return annotation;\n  };\n\n  annotation.ids = function(_) {\n    if (!arguments.length) return ids;\n    ids = _;\n    return annotation;\n  };\n\n  annotation.editMode = function(_) {\n    if (!arguments.length) return editMode;\n    editMode = _;\n\n    if (sel) {\n      sel.selectAll(\"g.annotation\").classed(\"editable\", editMode);\n    }\n\n    if (collection) {\n      collection.editMode(editMode);\n      annotations = collection.annotations;\n    }\n    return annotation;\n  };\n\n  annotation.collection = function(_) {\n    if (!arguments.length) return collection;\n    collection = _;\n    return annotation;\n  };\n\n  annotation.on = function() {\n    const value = annotationDispatcher.on.apply(\n      annotationDispatcher,\n      arguments\n    );\n    return value === annotationDispatcher ? annotation : value;\n  };\n\n  return annotation;\n}\n","import annotation from './src/Adapter-d3'\nimport { Type, d3Label, d3Callout, d3CalloutCurve, d3CalloutElbow, d3CalloutCircle, \n d3CalloutRect, d3XYThreshold, d3Badge, customType } from './src/Types-d3'\n\nexport {\n  annotation,\n  Type as annotationTypeBase ,\n  d3Label as annotationLabel ,\n  d3Callout as annotationCallout ,\n  d3CalloutCurve as annotationCalloutCurve ,\n  d3CalloutElbow as annotationCalloutElbow ,\n  d3CalloutCircle as annotationCalloutCircle ,\n  d3CalloutRect as annotationCalloutRect ,\n  d3XYThreshold as annotationXYThreshold ,\n  d3Badge as annotationBadge ,\n  customType as annotationCustomType \n}\n\nexport default {\n  annotation,\n  annotationTypeBase : Type,\n  annotationLabel : d3Label,\n  annotationCallout : d3Callout,\n  annotationCalloutCurve : d3CalloutCurve,\n  annotationCalloutElbow : d3CalloutElbow,\n  annotationCalloutCircle : d3CalloutCircle,\n  annotationCalloutRect : d3CalloutRect,\n  annotationXYThreshold : d3XYThreshold,\n  annotationBadge : d3Badge,\n  annotationCustomType : customType\n}"],"names":["Annotation","x","y","nx","ny","dy","dx","data","type","subject","connector","note","disable","id","className","_dx","undefined","_dy","_x","_y","_className","setPosition","selectAll","nodes","length","redrawSubject","setOffset","redrawConnector","redrawNote","setClassName","updatePosition","updateOffset","json","Object","keys","AnnotationCollection","annotations","accessors","accessorsInverse","newSettings","forEach","d","setPositionWithAccessors","editMode","a","updateEditMode","remove","textWrap","updateTextWrap","drawText","notePadding","map","k","getNoteBBoxOffset","positionX","positionY","pointHandle","cx","cy","move","circleHandles","r1","r2","padding","h","Math","sqrt","addHandles","group","handles","r","enter","append","attr","call","drag","container","select","node","on","start","end","exit","leftRightDynamic","align","topBottomDynamic","orientationTopBottom","orientationLeftRight","bbox","width","height","orientation","offset","indexOf","lineBuilder","curve","curveLinear","canvasContext","classID","lineGen","line","builder","context","pathMethods","attrs","arcBuilder","arcShape","arc","innerRadius","outerRadius","radius","startAngle","endAngle","PI","components","lineSetup","subjectType","annotation","position","x1","x2","y1","y2","subjectData","angle","asin","radiusPadding","abs","cos","sin","connectorData","diffY","diffX","xe","ye","opposite","acos","points","createPoints","curveCatmullRom","cHandles","c","i","index","updatePoint","event","mapHandles","bind","anchors","diff","p","push","size","angleOffset","atan","dot","transform","updateRadius","rect","updateWidth","updateHeight","rHandles","typeSettings","circlebg","circle","pointer","dragBadge","bHandles","text","Type","dispatcher","noteContent","handler","addHandlers","component","name","offsetCornerX","offsetCornerY","init","mapX","mapY","builders","Array","isArray","filter","b","el","addAttrs","removeAttrs","currentAttrs","attributes","bboxWithoutHandles","split","parseFloat","offsetX","offsetY","subjectParams","subjectCircle","subjectRect","subjectThreshold","subjectBadge","concat","dragSubject","connectorParams","connectorCurve","connectorElbow","connectorLine","endType","s","e","distance","pow","connectorArrow","connectorDot","noteData","noteParams","lineType","noteVertical","noteHorizontal","dragNote","noteAlignment","drawFunction","drawOnSVG","drawOnScreen","drawSubject","drawConnector","getNoteBBox","drawNoteContent","drawNote","sourceEvent","stopPropagation","classed","style","dragstarted","dragended","customType","initialType","settings","babelHelpers.get","babelHelpers.extends","d3NoteText","params","titleBBox","label","wrapLength","wrap","title","getBBox","d3Label","d3Callout","d3CalloutElbow","d3CalloutCurve","d3Badge","d3CalloutCircle","d3CalloutRect","ThresholdMap","d3XYThreshold","newWithClass","merge","lineHeight","each","words","reverse","w","word","tspan","pop","join","getComputedTextLength","selection","selector","reduce","min","max","yOffset","value","collection","ids","annotationDispatcher","dispatch","sel","translatedAnnotations","annotationG","toString","draw","log","copy","JSON","stringify","update","updateText","updatedAccessors","_","arguments","updateDisable","updateNotePadding","rerun","some","apply"],"mappings":"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"}